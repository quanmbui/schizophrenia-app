{
    "collab_server" : "",
    "contents" : "panss.data1 <- read.csv(\"panss-data.csv\", stringsAsFactors=FALSE)\npatient.list<-unique(panss.data$id)\n\n####\n\nonsetagedf <- as.data.frame(cbind(id = panss.data$id, onset = panss.data$onsetage))\nonsetagedf <- onsetagedf[!duplicated(onsetagedf$id),]\nonsetagedf <- na.omit(onsetagedf)\n\nonset.hist <- hist(onsetagedf$onset, plot = FALSE)\n\nhist(onsetagdf$onset) <- hist(onsetagedf$onset, xlab=\"Age at Symptom Onset in Years\", \n     ylab=\"Number of Patients\", main=\"Age at Symptom Onset (523 Patients)\", xlim=c(0,45), \n     xaxt=\"n\", labels=TRUE, col=ifelse(onset.hist$breaks < input$age, \"#adebad\", \"forestgreen\"))\naxis(side = 1, at = seq(0, 45, by = 5), labels = TRUE, tcl = -0.2)\n\nh <- hist(onsetagedf$onset, xlab=\"Age at Symptom Onset in Years\", ylab=\"Number of Patients\",\n         main=\"Age at Symptom Onset (523 Patients)\", xlim=c(0,45), xaxt=\"n\", labels=TRUE)\n         col=ifelse(onset.hist$breaks < input$age, \"#adebad\", \"forestgreen\"))\nh$density = h$counts/sum(h$counts)*100\nplot(h, xlab=\"Age at Symptom Onset in Years\", ylab=\"Percentage of Patients\",\n     main=\"Age at Symptom Onset (523 Patients)\", freq=FALSE)\nOnsetAgeinput <-  panss.data$onsetage[which(panss.data$onsetage == input$age)]\n\n\n  ####\n\n  # Make a dataframe with one record per patient\n  pt.data<-data.frame(id=unique(panss.data$id))\n  \n  # How many patients do we have?\n  (n<-dim(pt.data)[1])\n  \n  \n  ### More about text\n  p(\"Our app is designed using a data set obtained from Marder, M.D. and Meibach, Ph.D’s clinical trial evaluating the effectiveness of risperidone in treating patients with schizophrenia.\"),\n  br(),\n  p(\"Variables provided include:\"),\n  p(tags$b(\" •\tid\"), \"assigns each patient with a unique id number\"),\n  p(tags$b(\" •\tpospan\"), \"gives the patient’s score for positive symptoms\"),\n  p(tags$b(\" •\tnegpan\"), \"gives the patient’s score for negative symptoms\"), \n  p(tags$b(\" •\tgenpan\"), \"gives the patient’s score for general symptoms\"),\n  p(tags$b(\" •\ttotpan\"), \"gives the patient’s total score for symptoms (total of pospan, negpan, and genpan)\"),\n  p(tags$b(\" •\ttreatment\"), \"indicates the assigned treatment group for the patient, either PLACEBO, RISPERIDONE_2MG, RISPERIDONE_6MG, RISPERIDONE_10MG, RISPERIDONE_16MG, or HALOPERIDOL. These groups correspond to differing medications and dosages\"),\n  p(tags$b(\" •\ttime\"), \"refers to the week in the study, receiving a value between -1 and 8, with -1 corresponding to the week prior to the start of treatment\"),\n  p(tags$b(\" •\tage\"), \"refers to the age of the patient at baseline and is consistent throughout the duration of the study\"),\n  p(tags$b(\" •\tonsetage\"), \"gives the age at which schizophrenic symptoms were first experienced\"),\n  p(tags$b(\" •\tfirsthospage\"), \"gives the age at the patient’s first hospitalization for schizophrenic symptoms\"),\n  p(tags$b(\" •\tsex\"), \"gives the patient’s gender, either Male or Female\"),\n  p(tags$b(\" •\trace\"), \"gives the patient’s race, either White, Oriental, Polynesian/East Asian, Black, Hispanic, American Indian\"),\n  br(),\n  \n  \n  ### Working on pie charts for race, gender, age\n  \n  output$racepie <- renderPlot({\n    race_table <- as.data.frame(cbind(id = panss.data$id, race = panss.data$race))\n    race_table <- race_table[!duplicated(race_table$id),]\n    race_table <- na.omit(race_table)\n      \n    racepie = race_table$race\n    race.freq = table(race_table$race)\n    pielabels = c(\"American Indian\", \"Black\", \"Hispanic\", \"Oriental\", \"Polynesian/East Asian\", \"White\")\n    pie(race.freq, labels=pielabels, main = \"Race Distribution of Study Participants\", cex = 1.0)\n  })\n  \n  output$sexpie <- renderPlot({\n    sex_table <- as.data.frame(cbind(id = panss.data$id, sex = panss.data$sex))\n    sex_table <- sex_table[!duplicated(sex_table$id),]\n    sex_table <- na.omit(sex_table)\n    \n    sexpie = sex_table$sex\n    sex.freq = table(sex_table$sex)\n    piecolors = c(\"pink\", \"lightblue\")\n    piepercent <- round(100*sex.freq/sum(sex.freq),1)\n    pie(sex.freq, labels = c(\"Female\", \"Male\"), col = piecolors, \n       main = \"Sex Distribution of Study Participants\", cex = 1.0)\n    })\n  \n  ### \n  output$agepie <- renderPlot({\n    age_table <- as.data.frame(cbind(id = panss.data$id, agedf = panss.data$age))\n    age_table <- age_table[!duplicated(agedf$id),]\n    \n    Age0to15 <- subset(age_table, as.numeric(age_table$age) > 0 & as.numeric(age_table$age) <= 15, select = c(id, age))\n    Age15to30 <- subset(age_table, as.numeric(age) > 15 & as.numeric(age) <=30, select = c(id, age))\n    Age30to45 <- subset(age_table, as.numeric(age) > 30 & as.numeric(age) <=45, select = c(id, age))\n    Age45to65 <- subset(age_table, as.numeric(age) > 45 & as.numeric(age) <=65, select = c(id, age))\n    \n    AgeGroup1 <- data.frame(group = \"0-15 Years\", value = Age0to15$age)\n    AgeGroup2 <- data.frame(group = \"15-30 Years\", value = Age15to30$age)\n    AgeGroup3 <- data.frame(group = \"30-45 Years\", value = Age30to45$age)\n    AgeGroup4 <- data.frame(group = \"45-65 Years\", value = Age45to65$age)\n    \n    age.groups <- rbind(AgeGroup1, AgeGroup2, AgeGroup3, AgeGroup4)\n    \n    agepie = age.groups$age\n    age.freq = table(age.groups$age)\n    agepercent <- round(100*age.freq/sum(age.freq),1)\n    pie(age.freq, main = \"Age Distribution of Study Participants\", cex = 1.0)\n    \n  })\n  \n\n  ###\n  \n  output$BMItext <- renderText({\n    \n    for(i in 1:154){\n      if(!(input$treatment %in% panss.data$treatment)){\n        output <- c(\" \")\n      }else{\n        if(input$treatment == \"Placebo\"){\n          output <- c(\"Patients taking placebo reported an average PANSS score reduction of\", ... )\n        }}\n    }\n    paste0(output)\n  })\n  \n  \n  \n  \n  \n  panss.data <- as.data.frame(panss.data)\n  patient.list<-unique(panss.data$id)\n  \n  belowonset_df <- cbind(id = panss.data$id, onsetage = panss.data$onsetage)\n  belowonset_df <- as.data.frame(belowonset_df)\n  belowonset_df <- belowonset_df[!duplicated(belowonset_df$id),]\n  belowonset_df <- na.omit(belowonset_df)\n  \n  belowonset_df <- subset(belowonset_df, as.numeric(onsetage) > input$age, select=c(id, onsetage))\n  percentbelow <-  round(100*belowage_table/sum(belowage_table),1)\n  \n  # Reactive text\n  \n  output$onsetagetext <- renderText({\n    \n    belowdf <- onsetagedf$onset < input$age\n    \n    for(i in 1:523){\n      if(!(input$age %in% panss.data$onsetage)){\n        output <- c(\"Sorry, but this information is not in the dataset!\")\n      }else{\n        if(input$age > panss.data$onsetage){\n          output <- c(\"Approximately\", #round(100*XX/sum(XX),1),\"of patients exhibited first symptoms at a younger age than you.\")\n        }}\n    }\n    paste0(output)\n    \n  })\n          \n          library(ggplot2)\n          \n          onsetagedf <- as.data.frame(cbind(id = panss.data$id, onset = panss.data$onsetage))\n          onsetagedf <- onsetagedf[!duplicated(onsetagedf$id),]\n          onsetagedf <- na.omit(onsetagedf)\n  \n          OnsetAgefreq <- ggplot(data = onsetagedf, aes(onsetagedf$onset)) + \n            geom_histogram(binwidth = 7, ylim=c(0,250), xlim=c(0,45), colour=\"black\", fill=\"cyan\") + \n            labs(x = \"Age at Symptom Onset in Years\",\n                 y = \"Number of Patients\")\n          OnsetAgefreq\n  \n  \n          \n          \n          #Univariate Visualization of Onset Age\n          \n          output$onsetageplot <- renderPlot({\n            \n            onsetagedf <- as.data.frame(cbind(id = panss.data$id, onset = panss.data$onsetage))\n            onsetagedf <- onsetagedf[!duplicated(onsetagedf$id),]\n            onsetagedf <- na.omit(onsetagedf)\n            \n            onset.hist <- hist(onsetagedf$onset, breaks=seq(0,250,5), plot = FALSE)\n            \n            hist(onsetagedf$onset, breaks=seq(0,250,5), xlab=\"Age at Symptom Onset in Years\",\n                 ylab=\"Number of Patients\" , main=\"Age at Symptom Onset (523 Patients)\", ylim=c(0,250), xlim=c(0,45),\n                 xaxt=\"n\", labels=TRUE, col=ifelse(onset.hist$breaks < input$age, \"#adebad\", \"forestgreen\"))\n            axis(side = 1, at = seq(0, 45, by = 5), labels = TRUE, tcl = -0.2)\n            OnsetAgeinput <-  panss.data$onsetage[which(panss.data$onsetage == input$age)]\n          })\n          \n  \n  ",
    "created" : 1460474456753.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "28302843",
    "id" : "AC3CEBAB",
    "lastKnownWriteTime" : 1461431551,
    "last_content_update" : 1461431551445,
    "path" : "~/Final Project Work/Working doc.R",
    "project_path" : "Working doc.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}