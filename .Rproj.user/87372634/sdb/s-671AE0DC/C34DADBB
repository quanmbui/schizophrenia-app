{
    "collab_server" : "",
    "contents" : "library(shiny)\nlibrary(ggplot2)\n\nfoodgov <- read.csv(\"FoodGov.csv\", header = TRUE, stringsAsFactors = FALSE, sep=\",\")\nBMI <- read.csv(\"SugarBMI.csv\", header = TRUE, stringsAsFactors = FALSE)\nBMICancer <- read.csv(\"BMICancer.csv\", header = TRUE, stringsAsFactors = FALSE)\nSugarBMI <- read.csv(\"SugarBMI.csv\", header = TRUE, stringsAsFactors = FALSE)\n\n\nshinyServer(function(input, output) ({\n  \n  \n  # Set output plot of government health expenditures vs. food supply\n  output$FoodGov <- renderPlot({\n    \n    for(i in 1:167){\n      if(!(input$in2 %in% foodgov$Nation)){\n        output_v <- 1500\n        output_h <- 1000\n      }else{\n        if(foodgov[i,1] == input$in2){\n          output_v <- foodgov[i,2]\n          output_h <- foodgov[i,6]\n        }}\n    }\n    \n    Food_Gov <- ggplot(data = foodgov,\n                       mapping = aes(x=Food, y=Money, color=factor(Develop))) +\n      # Set aesthetics to fixed value\n      geom_point(size = 2) + \n      geom_vline(data <- data.frame(output_v), xintercept = output_v) +\n      geom_hline(data <- data.frame(output_h), yintercept = output_h) +\n      geom_smooth(method = \"lm\", se = FALSE) + \n      labs(x = \"Food Supply by Nation (KCal/Person & Day)\",\n           y = \"GDP Expenditure on Healthcare by Nation (per capita, Int $)\") +\n      scale_color_manual(values=c(\"cyan3\", \"purple\", \"black\"), name = \"Type of Nation\", labels = c(\"Developed\", \"Developing\", \"Least Developed\"))+\n      ggtitle(\"Health Expenditure v. Food Supply\")\n    Food_Gov\n  })\n  \n  # Set output text for government health expenditures vs. food supply\n  output$FoodGovtext <- renderText({\n    \n    for(i in 1:167){\n      if(!(input$in2 %in% foodgov$Nation)){\n        output <- c(\"Sorry, but this nation is not in the dataset!\")\n      }else{\n        if(foodgov[i,1] == input$in2){\n          output <- c(foodgov[i,1], \"has an annual government health expenditure (Int $) of\", foodgov[i,6], \"per capita and a food supply of\", foodgov[i,2], \"kilocalories per person per day.\")\n        }}\n    }\n    paste0(output)\n  })\n  \n  # Set output plot of BMI frequencies\n  output$BMIfreq <- renderPlot({\n    BMIfreq <- ggplot(data = SugarBMI, aes(SugarBMI$BMI)) + \n      geom_histogram(binwidth=input$in4, colour=\"black\", fill=\"cyan\") + \n      labs(x = \"BMI (kg/m^2)\",\n           y = \"Frequency\")\n    BMIfreq\n  })\n  \n  # Set data frames for breast cancer incidence subsets\n  LowIncidence <- subset(BMICancer, as.numeric(Incidence) < 33, select = c(Nation, BMI, Incidence))\n  MediumIncidence <- subset(BMICancer, as.numeric(Incidence) > 33 & as.numeric(Incidence) < 66, select = c(Nation, BMI, Incidence))\n  HighIncidence <- subset(BMICancer, as.numeric(Incidence) > 66 & as.numeric(Incidence) < 120, select = c(Nation, BMI, Incidence))\n  \n  Cancer1 <- data.frame(group = \"Low Incidence (< 33 people) \", value = LowIncidence$BMI)\n  Cancer2 <- data.frame(group = \"Medium Incidence (33-66 people)\", value = MediumIncidence$BMI)\n  Cancer3 <- data.frame(group = \"High Incidence (> 66 people)\", value = HighIncidence$BMI)\n  \n  plot.data <- rbind(Cancer1, Cancer2, Cancer3)\n  \n  # Set output plot of breast cancer incidence vs. BMI\n  output$BMIcancer <- renderPlot({\n    \n    if(input$in1 %in% LowIncidence$Nation){\n      colors = c(\"cyan\", \"red\", \"red\")\n    } else {\n      if(input$in1 %in% MediumIncidence$Nation) {colors = c(\"red\", \"cyan\", \"red\")}\n      else{\n        if(input$in1 %in% HighIncidence$Nation){colors = c(\"red\", \"red\", \"cyan\")}\n        else{colors = c(\"lightsalmon\")}\n      }\n    }\n    \n    BMIcancer <- ggplot(plot.data, aes(x=group, y=value)) + \n      geom_boxplot(col=colors) + \n      labs(x = \"Breast Cancer Incidence (per 100,000 people)\",\n           y = \"BMI (kg/m^2)\") \n    BMIcancer\n  })\n  output$BMI <- renderText({\n    \n    for(i in 1:173){\n      if(!(input$in1 %in% BMICancer$Nation)){\n        output_BMI <- c(\"Sorry, but this nation is not in the dataset!\")\n      }else{\n        if(BMICancer[i,1] == input$in1){\n          output_BMI <- c(BMICancer[i,1], \" has a BMI of \", BMICancer[i,2], \" and a breast cancer incidence of \", BMICancer[i,3])\n        }}\n    }\n    paste0(output_BMI)\n    \n    \n  })\n  \n  \n})\n)",
    "created" : 1461290306583.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "641045734",
    "id" : "C34DADBB",
    "lastKnownWriteTime" : 1459276845,
    "last_content_update" : 1459276845,
    "path" : "~/HW 5 Final Submission/server.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}